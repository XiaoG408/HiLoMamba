Thu 31 Jul 2025 23:18:58 INFO  ['run_recbole.py', '--gpu_id=1', '--model=MyModel', '--dataset=steam', '--config_files=config/steam.yaml']
Thu 31 Jul 2025 23:18:58 INFO  
General Hyper Parameters:
gpu_id = 1
use_gpu = True
seed = 212
state = INFO
reproducibility = True
data_path = /home/gujn/MyData/dataset/RecSysDatasets/steam
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 300
train_batch_size = 2048
learner = adam
learning_rate = 0.005
train_neg_sample_args = {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = True
metrics = ['Recall', 'NDCG', 'MRR']
topk = [5, 10, 20]
valid_metric = Recall@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [5,inf)
item_inter_num_interval = [5,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 80
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.SEQUENTIAL
embedding_size = 16
hidden_size = 16
hidden_dropout_prob = 0.285
hidden_act = gelu
layer_norm_eps = 1e-12
initializer_range = 0.02
loss_type = CE
c = 4
d_state = 16
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cuda
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Thu 31 Jul 2025 23:19:22 INFO  steam
The number of users: 25390
Average actions of users: 12.929930284768995
The number of items: 4090
Average actions of items: 80.28319882611885
The number of inters: 328278
The sparsity of the dataset: 99.68387723638381%
Remain Fields: ['user_id', 'item_id', 'timestamp']
Thu 31 Jul 2025 23:19:26 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}]
Thu 31 Jul 2025 23:19:26 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Thu 31 Jul 2025 23:19:26 INFO  MyModel(
  (item_embedding): Embedding(4090, 16, padding_idx=0)
  (loss_fct): CrossEntropyLoss()
  (mamba1): MambaBlock(
    (in_proj): Linear(in_features=16, out_features=32, bias=False)
    (x_proj): Linear(in_features=16, out_features=49, bias=False)
    (dt_proj): Linear(in_features=1, out_features=16, bias=True)
    (conv1d): Conv1d(16, 16, kernel_size=(2,), stride=(1,), padding=(1,))
    (out_proj): Linear(in_features=16, out_features=16, bias=False)
  )
  (mamba2): MambaBlock(
    (in_proj): Linear(in_features=80, out_features=160, bias=False)
    (x_proj): Linear(in_features=80, out_features=117, bias=False)
    (dt_proj): Linear(in_features=5, out_features=80, bias=True)
    (conv1d): Conv1d(80, 80, kernel_size=(2,), stride=(1,), padding=(1,))
    (out_proj): Linear(in_features=80, out_features=80, bias=False)
  )
  (fusion): ProjectFusion(
    (sigmoid): Sigmoid()
  )
  (linear_out): Linear(in_features=16, out_features=16, bias=True)
  (LayerNorm): LayerNorm((16,), eps=1e-12, elementwise_affine=True)
  (dropout): Dropout(p=0.285, inplace=False)
  (high_gru): GRU(16, 16, batch_first=True)
)
Trainable parameters: 111440
Thu 31 Jul 2025 23:19:26 INFO  FLOPs: 752656.0
Thu 31 Jul 2025 23:19:42 INFO  epoch 0 training [time: 15.31s, train loss: 877.2820]
Thu 31 Jul 2025 23:19:42 INFO  epoch 0 evaluating [time: 0.34s, valid_score: 0.117100]
Thu 31 Jul 2025 23:19:42 INFO  valid result: 
recall@5 : 0.0696    recall@10 : 0.1171    recall@20 : 0.1892    ndcg@5 : 0.0457    ndcg@10 : 0.0609    ndcg@20 : 0.0792    mrr@5 : 0.0379    mrr@10 : 0.0441    mrr@20 : 0.0491
Thu 31 Jul 2025 23:19:42 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:19:58 INFO  epoch 1 training [time: 15.61s, train loss: 845.8696]
Thu 31 Jul 2025 23:19:58 INFO  epoch 1 evaluating [time: 0.35s, valid_score: 0.137100]
Thu 31 Jul 2025 23:19:58 INFO  valid result: 
recall@5 : 0.0806    recall@10 : 0.1371    recall@20 : 0.2087    ndcg@5 : 0.052    ndcg@10 : 0.07    ndcg@20 : 0.0882    mrr@5 : 0.0427    mrr@10 : 0.0499    mrr@20 : 0.0549
Thu 31 Jul 2025 23:19:58 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:20:14 INFO  epoch 2 training [time: 15.32s, train loss: 839.6892]
Thu 31 Jul 2025 23:20:14 INFO  epoch 2 evaluating [time: 0.35s, valid_score: 0.141800]
Thu 31 Jul 2025 23:20:14 INFO  valid result: 
recall@5 : 0.0816    recall@10 : 0.1418    recall@20 : 0.2115    ndcg@5 : 0.0527    ndcg@10 : 0.072    ndcg@20 : 0.0896    mrr@5 : 0.0432    mrr@10 : 0.0511    mrr@20 : 0.0559
Thu 31 Jul 2025 23:20:14 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:20:30 INFO  epoch 3 training [time: 15.59s, train loss: 836.0714]
Thu 31 Jul 2025 23:20:30 INFO  epoch 3 evaluating [time: 0.35s, valid_score: 0.143500]
Thu 31 Jul 2025 23:20:30 INFO  valid result: 
recall@5 : 0.0869    recall@10 : 0.1435    recall@20 : 0.2111    ndcg@5 : 0.0558    ndcg@10 : 0.074    ndcg@20 : 0.091    mrr@5 : 0.0457    mrr@10 : 0.0531    mrr@20 : 0.0578
Thu 31 Jul 2025 23:20:30 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:20:45 INFO  epoch 4 training [time: 15.49s, train loss: 833.3612]
Thu 31 Jul 2025 23:20:46 INFO  epoch 4 evaluating [time: 0.30s, valid_score: 0.144000]
Thu 31 Jul 2025 23:20:46 INFO  valid result: 
recall@5 : 0.0863    recall@10 : 0.144    recall@20 : 0.2124    ndcg@5 : 0.0558    ndcg@10 : 0.0743    ndcg@20 : 0.0916    mrr@5 : 0.0458    mrr@10 : 0.0534    mrr@20 : 0.0581
Thu 31 Jul 2025 23:20:46 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:21:01 INFO  epoch 5 training [time: 15.25s, train loss: 831.6617]
Thu 31 Jul 2025 23:21:01 INFO  epoch 5 evaluating [time: 0.30s, valid_score: 0.144800]
Thu 31 Jul 2025 23:21:01 INFO  valid result: 
recall@5 : 0.0879    recall@10 : 0.1448    recall@20 : 0.2128    ndcg@5 : 0.0566    ndcg@10 : 0.0748    ndcg@20 : 0.092    mrr@5 : 0.0464    mrr@10 : 0.0538    mrr@20 : 0.0585
Thu 31 Jul 2025 23:21:01 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:21:17 INFO  epoch 6 training [time: 15.65s, train loss: 830.0339]
Thu 31 Jul 2025 23:21:17 INFO  epoch 6 evaluating [time: 0.31s, valid_score: 0.149400]
Thu 31 Jul 2025 23:21:17 INFO  valid result: 
recall@5 : 0.0902    recall@10 : 0.1494    recall@20 : 0.2178    ndcg@5 : 0.0586    ndcg@10 : 0.0775    ndcg@20 : 0.0947    mrr@5 : 0.0482    mrr@10 : 0.0559    mrr@20 : 0.0606
Thu 31 Jul 2025 23:21:17 INFO  Saving current: saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:21:32 INFO  epoch 7 training [time: 15.20s, train loss: 828.2249]
Thu 31 Jul 2025 23:21:33 INFO  epoch 7 evaluating [time: 0.31s, valid_score: 0.140700]
Thu 31 Jul 2025 23:21:33 INFO  valid result: 
recall@5 : 0.088    recall@10 : 0.1407    recall@20 : 0.2105    ndcg@5 : 0.0573    ndcg@10 : 0.0743    ndcg@20 : 0.0919    mrr@5 : 0.0473    mrr@10 : 0.0543    mrr@20 : 0.0591
Thu 31 Jul 2025 23:21:48 INFO  epoch 8 training [time: 15.34s, train loss: 826.9564]
Thu 31 Jul 2025 23:21:48 INFO  epoch 8 evaluating [time: 0.31s, valid_score: 0.141400]
Thu 31 Jul 2025 23:21:48 INFO  valid result: 
recall@5 : 0.0849    recall@10 : 0.1414    recall@20 : 0.21    ndcg@5 : 0.0562    ndcg@10 : 0.0743    ndcg@20 : 0.0916    mrr@5 : 0.0468    mrr@10 : 0.0542    mrr@20 : 0.0589
Thu 31 Jul 2025 23:22:04 INFO  epoch 9 training [time: 15.18s, train loss: 825.3359]
Thu 31 Jul 2025 23:22:04 INFO  epoch 9 evaluating [time: 0.30s, valid_score: 0.141700]
Thu 31 Jul 2025 23:22:04 INFO  valid result: 
recall@5 : 0.0841    recall@10 : 0.1417    recall@20 : 0.211    ndcg@5 : 0.0557    ndcg@10 : 0.0742    ndcg@20 : 0.0917    mrr@5 : 0.0464    mrr@10 : 0.054    mrr@20 : 0.0588
Thu 31 Jul 2025 23:22:19 INFO  epoch 10 training [time: 15.08s, train loss: 823.9688]
Thu 31 Jul 2025 23:22:19 INFO  epoch 10 evaluating [time: 0.31s, valid_score: 0.138500]
Thu 31 Jul 2025 23:22:19 INFO  valid result: 
recall@5 : 0.0861    recall@10 : 0.1385    recall@20 : 0.2069    ndcg@5 : 0.0568    ndcg@10 : 0.0736    ndcg@20 : 0.0908    mrr@5 : 0.0473    mrr@10 : 0.0541    mrr@20 : 0.0588
Thu 31 Jul 2025 23:22:33 INFO  epoch 11 training [time: 14.01s, train loss: 822.9271]
Thu 31 Jul 2025 23:22:34 INFO  epoch 11 evaluating [time: 0.31s, valid_score: 0.141000]
Thu 31 Jul 2025 23:22:34 INFO  valid result: 
recall@5 : 0.0848    recall@10 : 0.141    recall@20 : 0.2091    ndcg@5 : 0.0557    ndcg@10 : 0.0737    ndcg@20 : 0.0909    mrr@5 : 0.0462    mrr@10 : 0.0535    mrr@20 : 0.0582
Thu 31 Jul 2025 23:22:48 INFO  epoch 12 training [time: 14.15s, train loss: 821.6577]
Thu 31 Jul 2025 23:22:48 INFO  epoch 12 evaluating [time: 0.30s, valid_score: 0.142000]
Thu 31 Jul 2025 23:22:48 INFO  valid result: 
recall@5 : 0.0842    recall@10 : 0.142    recall@20 : 0.2087    ndcg@5 : 0.0559    ndcg@10 : 0.0744    ndcg@20 : 0.0912    mrr@5 : 0.0466    mrr@10 : 0.0541    mrr@20 : 0.0587
Thu 31 Jul 2025 23:23:02 INFO  epoch 13 training [time: 14.00s, train loss: 820.6831]
Thu 31 Jul 2025 23:23:02 INFO  epoch 13 evaluating [time: 0.30s, valid_score: 0.142100]
Thu 31 Jul 2025 23:23:02 INFO  valid result: 
recall@5 : 0.0847    recall@10 : 0.1421    recall@20 : 0.2087    ndcg@5 : 0.0558    ndcg@10 : 0.0742    ndcg@20 : 0.091    mrr@5 : 0.0464    mrr@10 : 0.0539    mrr@20 : 0.0585
Thu 31 Jul 2025 23:23:16 INFO  epoch 14 training [time: 14.03s, train loss: 819.7905]
Thu 31 Jul 2025 23:23:17 INFO  epoch 14 evaluating [time: 0.31s, valid_score: 0.143100]
Thu 31 Jul 2025 23:23:17 INFO  valid result: 
recall@5 : 0.0853    recall@10 : 0.1431    recall@20 : 0.2098    ndcg@5 : 0.0563    ndcg@10 : 0.0749    ndcg@20 : 0.0916    mrr@5 : 0.0468    mrr@10 : 0.0544    mrr@20 : 0.059
Thu 31 Jul 2025 23:23:31 INFO  epoch 15 training [time: 14.04s, train loss: 818.7127]
Thu 31 Jul 2025 23:23:31 INFO  epoch 15 evaluating [time: 0.31s, valid_score: 0.138800]
Thu 31 Jul 2025 23:23:31 INFO  valid result: 
recall@5 : 0.0844    recall@10 : 0.1388    recall@20 : 0.2046    ndcg@5 : 0.0559    ndcg@10 : 0.0733    ndcg@20 : 0.0898    mrr@5 : 0.0466    mrr@10 : 0.0536    mrr@20 : 0.0581
Thu 31 Jul 2025 23:23:45 INFO  epoch 16 training [time: 14.02s, train loss: 818.1637]
Thu 31 Jul 2025 23:23:45 INFO  epoch 16 evaluating [time: 0.30s, valid_score: 0.137700]
Thu 31 Jul 2025 23:23:45 INFO  valid result: 
recall@5 : 0.085    recall@10 : 0.1377    recall@20 : 0.2034    ndcg@5 : 0.0562    ndcg@10 : 0.0731    ndcg@20 : 0.0896    mrr@5 : 0.0468    mrr@10 : 0.0537    mrr@20 : 0.0582
Thu 31 Jul 2025 23:24:00 INFO  epoch 17 training [time: 14.13s, train loss: 817.0597]
Thu 31 Jul 2025 23:24:00 INFO  epoch 17 evaluating [time: 0.30s, valid_score: 0.138700]
Thu 31 Jul 2025 23:24:00 INFO  valid result: 
recall@5 : 0.0832    recall@10 : 0.1387    recall@20 : 0.2051    ndcg@5 : 0.0549    ndcg@10 : 0.0726    ndcg@20 : 0.0894    mrr@5 : 0.0456    mrr@10 : 0.0529    mrr@20 : 0.0575
Thu 31 Jul 2025 23:24:00 INFO  Finished training, best eval result in epoch 6
Thu 31 Jul 2025 23:24:00 INFO  Loading model structure and parameters from saved/MyModel-Jul-31-2025_23-19-26.pth
Thu 31 Jul 2025 23:24:01 INFO  The running environment of this training is as follows:
+-------------+-----------------+
| Environment |      Usage      |
+=============+=================+
| CPU         |     4.40 %      |
+-------------+-----------------+
| GPU         | 5.57 G/23.65 G  |
+-------------+-----------------+
| Memory      | 1.61 G/125.53 G |
+-------------+-----------------+
Thu 31 Jul 2025 23:24:01 INFO  best valid : OrderedDict([('recall@5', 0.0902), ('recall@10', 0.1494), ('recall@20', 0.2178), ('ndcg@5', 0.0586), ('ndcg@10', 0.0775), ('ndcg@20', 0.0947), ('mrr@5', 0.0482), ('mrr@10', 0.0559), ('mrr@20', 0.0606)])
Thu 31 Jul 2025 23:24:01 INFO  test result: OrderedDict([('recall@5', 0.0827), ('recall@10', 0.141), ('recall@20', 0.2069), ('ndcg@5', 0.0531), ('ndcg@10', 0.0716), ('ndcg@20', 0.0883), ('mrr@5', 0.0434), ('mrr@10', 0.0509), ('mrr@20', 0.0555)])
